<UserControl x:Class="PopupCash.Contents.Views.AccumulateBrowserDialog"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             prism:ViewModelLocator.AutoWireViewModel="True"
             xmlns:cefSharpWpf="clr-namespace:CefSharp.Wpf;assembly=CefSharp.Wpf"
             xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:coreBehaviors="clr-namespace:PopupCash.Core.Presentation.Behavior;assembly=PopupCash.Core"
             xmlns:behaviours="clr-namespace:PopupCash.Contents.Presentation.Behaviours"
             xmlns:buttons="clr-namespace:PopupCash.Controls.Buttons;assembly=PopupCash.Controls"
             xmlns:converters="clr-namespace:PopupCash.Contents.Presentation.Converters"
             Padding="0">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
            </ResourceDictionary.MergedDictionaries>

        </ResourceDictionary>
    </UserControl.Resources>

    <prism:Dialog.WindowStyle>
        <Style TargetType="{x:Type Window}">
            <Setter Property="prism:Dialog.WindowStartupLocation"
                    Value="Manual" />
            <Setter Property="ResizeMode"
                    Value="CanResize" />
            <Setter Property="ShowInTaskbar"
                    Value="True" />            
            <Setter Property="WindowState"
                    Value="Normal" />
            <Setter Property="WindowStyle"
                    Value="None" />
            <Setter Property="HorizontalAlignment"
                    Value="Stretch" />
            <Setter Property="VerticalAlignment"
                    Value="Stretch" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Stretch" />
            <Setter Property="VerticalContentAlignment"
                    Value="Stretch" />            
            <Setter Property="BorderBrush"
                    Value="Transparent" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="MinWidth"
                    Value="374" />
            <Setter Property="MinHeight"
                    Value="800" />
            <Setter Property="Width"
                    Value="374" />
            <Setter Property="Height"
                    Value="800" />
            <Setter Property="Padding"
                    Value="0" />
            <Setter Property="Margin"
                    Value="0" />
            <Setter Property="AllowsTransparency"
                    Value="true" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="WindowChrome.WindowChrome">
                <Setter.Value>
                    <WindowChrome CaptionHeight="0"
                                  CornerRadius="15"/>
                </Setter.Value>
            </Setter>
        </Style>
    </prism:Dialog.WindowStyle>


    <behaviors:Interaction.Behaviors>
        <!--윈도우를 이동시키는 Behavior-->
        <coreBehaviors:DragWindowBehavior />
        <!--윈도우 위치 지정 Behavior-->
        <behaviours:DefaultAccumulateWindowPostionBehavior />
    </behaviors:Interaction.Behaviors>

    <behaviors:Interaction.Triggers>
        <behaviors:EventTrigger EventName="Loaded">
            <prism:InvokeCommandAction Command="{Binding LoadedDialogCommand}" />
        </behaviors:EventTrigger>
    </behaviors:Interaction.Triggers>
    

    <!--<behaviors:Interaction.Triggers>
        <behaviors:EventTrigger EventName="Loaded">
            <prism:InvokeCommandAction Command="{Binding LoadedWindowCommand}" />
        </behaviors:EventTrigger>
    </behaviors:Interaction.Triggers>-->

    <Border Style="{StaticResource windowBaseBorder}"
            Background="{StaticResource windowBackground}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0">
                <behaviors:Interaction.Behaviors>
                    <!--윈도우를 이동시키는 Behavior-->
                    <coreBehaviors:DragWindowBehavior />
                </behaviors:Interaction.Behaviors>

                <buttons:ImageButton Style="{StaticResource closeImageButton}"
                                     Command="{Binding CancelCommand}" />
            </Grid>
            <Grid Grid.Row="1">
                <cefSharpWpf:ChromiumWebBrowser x:Name="browser"
                                                Margin="10 0 10 1"
                                                Address="{Binding Address}"
                                                Padding="0">

                    <behaviors:Interaction.Triggers>
                        <behaviors:EventTrigger EventName="Initialized"
                                                SourceObject="{Binding ElementName=browser}">
                            <prism:InvokeCommandAction Command="{Binding BrowserInitializedCommand}"
                                                       CommandParameter="{Binding ElementName=browser}" />
                        </behaviors:EventTrigger>
                    </behaviors:Interaction.Triggers>
                </cefSharpWpf:ChromiumWebBrowser>
            </Grid>
        </Grid>
    </Border>
</UserControl>